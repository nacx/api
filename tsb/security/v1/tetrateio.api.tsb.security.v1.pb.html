---
title: Security Group
description: Configurations to group a set of sidecars in a workspace for security.
location: https://tetrate.io/docs/reference/config/security/v1/group.html
layout: protoc-gen-docs
generator: protoc-gen-docs
number_of_entries: 8
---
<p>Security Groups allow grouping the sidecars in a set of namespaces
owned by its parent workspace. Security related configurations can
then be applied on the group to control the behavior of these
sidecars. The group can be in one of two modes: <code>TETRATE</code> and
<code>ISTIO</code>. <code>TETRATE</code> mode is a minimalistic mode that allows users to
quickly configure the most commonly used features in the service
mesh using Tetrate specific APIs, while the <code>ISTIO</code> mode provides
more flexibility for power users by allowing them to configure the
sidecar&rsquo;s security properties using a restricted subset of Istio
Security APIs.</p>

<p>The following example creates a security group for the sidecars in
<code>ns1</code>, <code>ns2</code> and <code>ns3</code> namespaces owned by its parent workspace
<code>w1</code> under tenant <code>mycompany</code></p>

<pre><code class="language-yaml">apiVersion: security.tsb.tetrate.io/v1
kind: Group
metadata:
  name: t1
  workspace: w1
  tenant: mycompany
spec:
  namespaceSelectors:
  - name: */ns1
  - name: */ns2
  - name: */ns3
  configMode: TETRATE
</code></pre>

<p>And the associated security settings for the sidecars in the group</p>

<pre><code class="language-yaml">apiVersion: security.tsb.tetrate.io/v1
kind: SecuritySetting
metadata:
  name: defaults
  group: t1
  workspace: w1
  tenant: mycompany
spec:
  authentication: REQUIRED
</code></pre>

<p>Under the hood, Service Bridge translates these minimalistic
settings into Istio APIs such as <code>PeerAuthentication</code>,
<code>AuthorizationPolicy</code>, etc. for the namespaces managed by the
security group. These APIs are then pushed to the Istio control
planes of clusters where the workspace is applicable.</p>

<p>It is possible to create a security group for namespaces in a
specific cluster as long as the parent workspace owns those
namespaces in that cluster. For example,</p>

<pre><code class="language-yaml">apiVersion: security.tsb.tetrate.io/v1
kind: Group
metadata:
  name: t1
  workspace: w1
  tenant: mycompany
spec:
  namespaceSelectors:
  - name: c1/ns1 # pick ns1 namespace only from c1 cluster
  - name: */ns2
  - name: */ns3
  configMode: TETRATE
</code></pre>

<p>In the <code>ISTIO</code> mode, it is possible to directly attach Istio
<code>PeerAuthentication</code>, <code>RequestAuthentication</code>, and
<code>AuthorizationPolicy</code> to the security group. These configurations
will be validated for correctness and conflict free operations and
then pushed to the appropriate Istio control planes.</p>

<p>The following example declares a <code>PeerAuthentication</code> policy for a
specific workload in the <code>ns1</code> namespace:</p>

<pre><code class="language-yaml">apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: workload-mtls-disable
  namespace: ns1
  annotations:
    tsb.tetrate.io/tenant: mycompany
    tsb.tetrate.io/workspace: w1
    tsb.tetrate.io/securityGroup: t1
spec:
  selector:
    matchLabels:
      app: reviews
  mtls:
    mode: DISABLE
</code></pre>

<p>The namespace where the Istio APIs are applied will need to be part
of the parent security group. In addition, each API object will need
to have annotations to indicate the tenant, workspace and the
security group to which it belongs to.</p>

<p>TODO(rshriram): Document the list of fields in Istio APIs that are
disallowed.</p>

<h2 id="Group">Group</h2>
<section>
<p>A security group manages the security properties of sidecars in a
group of namespaces owned by the parent workspace.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="Group-namespace_selectors">
<td><code>namespaceSelectors</code></td>
<td><code><a href="https://tetrate.io/docs/reference/config/types/v1/types.html#NamespaceSelector">NamespaceSelector[]</a></code></td>
<td>
<p>Set of namespaces owned exclusively by this group. If omitted,
applies to all resources owned by the workspace.</p>

</td>
<td>
No
</td>
</tr>
<tr id="Group-config_mode">
<td><code>configMode</code></td>
<td><code><a href="https://tetrate.io/docs/reference/config/types/v1/types.html#ConfigMode">ConfigMode</a></code></td>
<td>
<p>The Configuration types that will be added to this
group. <code>TETRATE</code> mode indicates that configurations added to this
group will use Tetrate APIs such as <code>SecuritySetting</code>. <code>ISTIO</code>
mode indicates that configurations added to this group will use
Istio Security APIs such as <code>PeerAuthentication</code>,
<code>RequestAuthentication</code>, and <code>AuthorizationPolicy</code>. Defaults to
<code>TETRATE</code> mode.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="tetrateio-api-tsb-types-v1-NamespaceSelector">tetrateio.api.tsb.types.v1.NamespaceSelector</h2>
<section>
<p><code>NamespaceSelector</code> selects a set of namespaces across one or more
clusters in a tenant. Namespace selectors can be used at Workspace
level to carve out a chunk of resources under a tenant into an
isolated configuration domain. They can be used in a Traffic,
Security, or a Gateway group to further scope the set of namespaces
that will belong to a specific configuration group.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="tetrateio-api-tsb-types-v1-NamespaceSelector-name">
<td><code>name</code></td>
<td><code>string</code></td>
<td>
<ul>
<li><p><code>*/ns1</code> implies <code>ns1</code> namespace in any cluster under the tenant.</p></li>

<li><p><code>c1/ns1</code> implies <code>ns1</code> namespace from <code>c1</code> cluster.</p></li>

<li><p><code>c1/*</code> implies all namespaces in <code>c1</code> cluster.</p></li>
</ul>

</td>
<td>
Yes
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="SecuritySetting">SecuritySetting</h2>
<section>
<p>A security setting applies configuration to a set of sidecars in a
security group or a workspace. When applied to a security group,
missing fields will inherit values from the workspace-wide setting.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="SecuritySetting-authentication">
<td><code>authentication</code></td>
<td><code><a href="https://tetrate.io/docs/reference/config/security/v1/security-setting.html#SecuritySetting-AuthenticationMode">AuthenticationMode</a></code></td>
<td>
<p>Specifies whether the sidecars should accept only mutual TLS
authenticated traffic or allow legacy plaintext traffic as well.</p>

</td>
<td>
No
</td>
</tr>
<tr id="SecuritySetting-authorization">
<td><code>authorization</code></td>
<td><code><a href="https://tetrate.io/docs/reference/config/security/v1/security-setting.html#AuthorizationSettings">AuthorizationSettings</a></code></td>
<td>
<p>The set of service accounts in one or more namespaces allowed to
access a workload (and hence its sidecar) in the mesh.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="AuthorizationSettings">AuthorizationSettings</h2>
<section>
<p><code>AuthorizationSettings</code> define the set of service accounts in one
or more namespaces allowed to access a workload (and hence its
sidecar) in the mesh.</p>

<p><strong>NOTE</strong>: When used in <code>WorkspaceSetting</code>, authorization if not
specified defaults to <code>NAMESPACE</code> mode, i.e. workloads will only
allow traffic from other workloads in the same namespace.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="AuthorizationSettings-mode">
<td><code>mode</code></td>
<td><code><a href="https://tetrate.io/docs/reference/config/security/v1/security-setting.html#AuthorizationSettings-Mode">Mode</a></code></td>
<td>
<p>A short cut for specifying the set of allowed callers.</p>

</td>
<td>
No
</td>
</tr>
<tr id="AuthorizationSettings-service_accounts">
<td><code>serviceAccounts</code></td>
<td><code>string[]</code></td>
<td>
<p>When the mode is <code>CUSTOM</code>, <code>serviceAccounts</code> specify the allowed
set of service accounts (and the workloads using them). Must be
in the <code>&lt;namespace&gt;/&lt;service-account-name&gt;</code> format.</p>

<ul>
<li><p><code>./*</code> indicates all service accounts in the namespace where the sidecar resides.</p></li>

<li><p><code>ns1/*</code> indicates all service accounts in the <code>ns1</code> namespace.</p></li>

<li><p><code>ns1/svc1-sa</code> indicates <code>svc1-sa</code> service account in <code>ns1</code> namespace.</p></li>
</ul>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="tetrateio-api-tsb-types-v1-ConfigMode">tetrateio.api.tsb.types.v1.ConfigMode</h2>
<section>
<p>The configuration mode used by a traffic, security or a gateway group.</p>

<table class="enum-values">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="tetrateio-api-tsb-types-v1-ConfigMode-TETRATE">
<td><code>TETRATE</code></td>
<td>
<p>Indicates that the configurations to be added to the group will use Tetrate APIs.</p>

</td>
</tr>
<tr id="tetrateio-api-tsb-types-v1-ConfigMode-ISTIO">
<td><code>ISTIO</code></td>
<td>
<p>Indicates that the configurations to be added to the group will use Istio APIs.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="tetrateio-api-tsb-types-v1-ConfigMode">tetrateio.api.tsb.types.v1.ConfigMode</h2>
<section>
<p>The configuration mode used by a traffic, security or a gateway group.</p>

<table class="enum-values">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="tetrateio-api-tsb-types-v1-ConfigMode-TETRATE">
<td><code>TETRATE</code></td>
<td>
<p>Indicates that the configurations to be added to the group will use Tetrate APIs.</p>

</td>
</tr>
<tr id="tetrateio-api-tsb-types-v1-ConfigMode-ISTIO">
<td><code>ISTIO</code></td>
<td>
<p>Indicates that the configurations to be added to the group will use Istio APIs.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="SecuritySetting-AuthenticationMode">SecuritySetting.AuthenticationMode</h2>
<section>
<p>AuthenticationMode indicates whether to accept only Istio mutual
TLS authenticated traffic or allow legacy plaintext traffic as
well.</p>

<table class="enum-values">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="SecuritySetting-AuthenticationMode-UNSET">
<td><code>UNSET</code></td>
<td>
<p>Inherit from parent, if has one. Otherwise treated as OPTIONAL.</p>

</td>
</tr>
<tr id="SecuritySetting-AuthenticationMode-OPTIONAL">
<td><code>OPTIONAL</code></td>
<td>
<p>Accept both plaintext and mTLS authenticated connections.</p>

</td>
</tr>
<tr id="SecuritySetting-AuthenticationMode-REQUIRED">
<td><code>REQUIRED</code></td>
<td>
<p>Accept only mutual TLS authenticated connections.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="AuthorizationSettings-Mode">AuthorizationSettings.Mode</h2>
<section>
<p>A short cut for defining the common authorization patterns</p>

<table class="enum-values">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="AuthorizationSettings-Mode-UNSET">
<td><code>UNSET</code></td>
<td>
<p>Inherit from parent if possible. Otherwise treated as <code>DISABLED</code>.</p>

</td>
</tr>
<tr id="AuthorizationSettings-Mode-NAMESPACE">
<td><code>NAMESPACE</code></td>
<td>
<p>The workload allows traffic from any other authenticated workload in its own
namespace.</p>

</td>
</tr>
<tr id="AuthorizationSettings-Mode-GROUP">
<td><code>GROUP</code></td>
<td>
<p>The workload allows traffic from any other authenticated workload in the security group.</p>

</td>
</tr>
<tr id="AuthorizationSettings-Mode-WORKSPACE">
<td><code>WORKSPACE</code></td>
<td>
<p>The workload allows traffic from any other authenticated workload in the workspace.</p>

</td>
</tr>
<tr id="AuthorizationSettings-Mode-CLUSTER">
<td><code>CLUSTER</code></td>
<td>
<p>The workload allows traffic from any other authenticated workload in the cluster.</p>

</td>
</tr>
<tr id="AuthorizationSettings-Mode-DISABLED">
<td><code>DISABLED</code></td>
<td>
<p>Authorization is disabled.</p>

</td>
</tr>
<tr id="AuthorizationSettings-Mode-CUSTOM">
<td><code>CUSTOM</code></td>
<td>
<p>The workload allows traffic from service accounts defined explicitly.</p>

</td>
</tr>
</tbody>
</table>
</section>
